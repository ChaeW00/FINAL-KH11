<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="team">
	<!-- 시퀀스 발행 -->
  	<select id="sequence" resultType="int">
  		select team_seq.nextval from dual
  	</select>

    <!-- Insert 팀생성 -->
    <insert id="insert" parameterType="TeamDto">
        INSERT INTO team(
        team_no, team_leader, team_name, team_info, team_city, team_location, team_day, team_time, team_gender, team_age, img_no)
        VALUES
        (#{teamNo}, #{teamLeader}, #{teamName}, #{teamInfo}, #{teamCity}, #{teamLocation}, #{teamDay}, #{teamTime}, #{teamGender}, #{teamAge}, #{imgNo})
    </insert>
	 
    <!-- Select 팀 전체조회-->
	<select id="selectList" resultType="TeamDto">
    	SELECT * FROM team order by team_no asc
	</select>

    <!-- Select 상세조회 -->
    <select id="selectOne" resultType="TeamDto" parameterType="int" >
        SELECT * FROM team WHERE team_no = #{teamNo}
    </select>

    <!-- Update 전체 수정 -->
    <update id="edit" parameterType="TeamDto">
        UPDATE team 
        	SET
            team_name = #{teamName},
            team_info = #{teamInfo},
            team_day = #{teamDay},
            team_time = #{teamTime},
            team_city = #{teamCity},
            team_location = #{teamLocation},
            team_gender = #{teamGender},
            team_age = #{teamAge}
<!--             team_level = #{teamLevel}, -->
<!--             team_win = #{teamWin}, -->
<!--             team_lose = #{teamLose}, -->
<!--             team_schedule = #{teamSchedule} -->
			<if test="imgNo != 0">img_no = #{imgNo},</if>
		    <if test="imgNo == 0">img_no = 0,</if>
        WHERE team_no = #{teamNo}
    </update>

    <!-- Delete 팀삭제 -->
    <delete id="remove" parameterType="int">
        DELETE team WHERE team_no = #{teamNo}
    </delete>
    
     <!-- Select 팀 리스트 조회 (리더 아이디로) 되긴함--> 
    <select id="selectTeamByLeaderId" resultType="TeamDto">
       SELECT * FROM team WHERE team_leader = #{memberId}
    </select>
    
    <update id="plusWin">
    	update team set team_win = team_win + 1
    	where team_no = #{teamNo}
    </update>
    
    <update id="minusWin">
    	update team set team_win = team_win - 1
    	where team_no = #{teamNo}
    </update>
    
    <update id="plusLose">
    	update team set team_lose = team_lose + 1
    	where team_no = #{teamNo}
    </update>
    
    <update id="minusLose">
    	update team set team_lose = team_lose - 1
    	where team_no = #{teamNo}
    </update>
    
    
    <!-- 내가 가입한 팀 조회 -->
<!-- 	 <select id="myTeam" parameterType="String" resultType="MyTeamVO"> -->
<!-- 		select myteam.team_no,myteam.team_name, myteam.team_city, myteam.team_leader from member ab left outer join -->
<!-- 		(select * from team a inner join team_member am on a.team_no = am.team_member_team_no) myteam on ab.member_id = myteam.team_member_id where ab.member_id =#{memberId} -->
<!-- 	</select> -->
    
    <!--  팀매칭이 잡혔을 경우 스케쥴 업데이트 -->
<!-- 	<update id="schedule" parameterType="TeamDto"> -->
<!--     	UPDATE team SET -->
<!--         team_schedule = #{teamSchedule} -->
<!--     	WHERE team_no = #{teamNo} -->
<!-- 	</update> -->
	
		<!--  전적 기록 (승패) 팀전적 수정 --> 
<!-- 	<update id="record" parameterType="TeamDto"> -->
<!--     	UPDATE team SET -->
<!--         team_win = #{teamWin}, -->
<!--         team_lose = #{teamLose} -->
<!--     	WHERE team_no = #{teamNo} -->
<!-- </update> -->
</mapper>